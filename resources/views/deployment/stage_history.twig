{% extends 'layouts.admin_main' %}

{% block title %}
	{{ stage.project.name }} {{ stage.name }} History
{% endblock %}

{% block toprightbuttons %}
    <a href="{{ url('deployment/start/' ~ stage.id) }}" class="btn btn-success"><i class="fa fa-cloud-upload"></i> Deploy</a>
{% endblock %}

{% block content %}
	<div class="row">
		<div class="col-lg-12">
			<div class="box">
				<!-- /.panel-heading -->
				<div class="box-body">
					<table width="100%" class="table table-striped table-bordered table-hover" id="datatables-users">
						<thead>
							<tr>
								<th>Started</th>
								<th>Completed</th>
								<th>Status</th>
								<th></th>
							</tr>
						</thead>
						<tbody>
							{% for dep in stage.deployments %}
								<tr class="odd gradeX">
									<td>{{ dep.created_at.timezone(config_get('app.output_timezone')).toDayDateTimeString() }}</td>
									<td>{{ dep.updated_at.timezone(config_get('app.output_timezone')).toDayDateTimeString() }}</td>
									<td>
										{% if dep.status == 'Queued' %}
											<span class="label label-info">
										{% elseif dep.status == 'Active' %}
											<span class="label label-warning">
										{% elseif dep.status == 'Complete' %}
											<span class="label label-success">
										{% elseif dep.status == 'Failed' %}
											<span class="label label-danger">
										{% endif %}
										{{ dep.status }}</span>
									</td>
									<td>
										<a href="{{ url('deployment/view/' ~ dep.id) }}" class="btn btn-danger btn-xs">View</a>
									</td>
								</tr>
							{% endfor %}
						</tbody>
					</table>
					<!-- /.table-responsive -->
				</div>
				<!-- /.panel-body -->
			</div>
			<!-- /.panel -->
		</div>
		<!-- /.col-lg-12 -->
	</div>
	<!-- /.row -->
{% endblock %}
